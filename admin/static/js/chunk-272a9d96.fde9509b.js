(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-272a9d96"],{"0d4b":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-button",{staticStyle:{margin:"5px 0"},attrs:{type:"primary"},on:{click:function(e){return t.handleCreate()}}},[a("a-icon",{attrs:{type:"plus"}}),t._v(" 添加文章 ")],1),a("a-table",{attrs:{columns:t.columns,"data-source":t.data,pagination:t.paginationProps,scroll:{x:1500,y:450},rowKey:function(t,e){return t._id}},scopedSlots:t._u([{key:"tag",fn:function(e,n){return[t.data.length?a("span",t._l(n.tag,(function(e,n){return a("a-tag",{key:n},[t._v(t._s(e))])})),1):t._e()]}},{key:"status",fn:function(e,n){return[t.data.length?a("span",[1==n.status?a("a",{attrs:{href:"javascript:;"}},[a("a-button",{staticStyle:{"background-color":"#e6f9f4","border-color":"#ccf3e9",color:"#00c292"},attrs:{type:"dashed"}},[t._v(" 启用中 ")])],1):a("a",{attrs:{href:"javascript:;"}},[a("a-button",{staticStyle:{"background-color":"#feeef0","border-color":"#fddce2",color:"#f4516c"},attrs:{type:"dashed"}},[t._v(" 禁用中 ")])],1)]):t._e()]}},{key:"action",fn:function(e,n){return a("a",{},[a("a-button",{staticStyle:{"margin-right":"20px"},attrs:{type:"primary"},on:{click:function(e){return t.handleUpdate(n)}}},[t._v(" 编辑 ")]),t.data.length?a("a-popconfirm",{attrs:{title:"确定要删除吗？"},on:{confirm:function(){return t.onDelete(n._id)}}},[a("a-button",{attrs:{type:"danger"}},[t._v(" 删除 ")])],1):t._e()],1)}}])}),a("a-drawer",{attrs:{title:"Create a new account",width:980,visible:t.visible,"body-style":{paddingBottom:"80px"}},on:{close:t.onClose}},[a("a-form",{attrs:{layout:"vertical","hide-required-mark":""}},[a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("a-form-item",{attrs:{label:"文章标题"}},[a("a-input",{attrs:{placeholder:"请输入文章标题"},model:{value:t.obj.title,callback:function(e){t.$set(t.obj,"title",e)},expression:"obj.title"}})],1)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:5}},[a("a-form-item",{attrs:{label:"封面图片"}},[a("a-upload",{staticClass:"avatar-uploader",attrs:{name:"file","list-type":"picture-card","show-upload-list":!1,headers:t.headers,action:"https://wudongming.com/admin/uploadImg","before-upload":t.beforeUpload},on:{change:t.handleChange}},[t.obj.img?a("img",{attrs:{src:t.obj.img,alt:"文章封面"}}):a("div",[a("a-icon",{attrs:{type:t.loading?"loading":"plus"}}),a("div",{staticClass:"ant-upload-text"},[t._v("上传")])],1)])],1)],1),a("a-col",{attrs:{span:19}},[a("a-form-item",{attrs:{label:"文章描述"}},[a("a-textarea",{attrs:{rows:6,placeholder:"请输入文章描述"},model:{value:t.obj.description,callback:function(e){t.$set(t.obj,"description",e)},expression:"obj.description"}})],1)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"文章分类"}},[a("a-select",{model:{value:t.obj.category,callback:function(e){t.$set(t.obj,"category",e)},expression:"obj.category"}},[a("a-select-option",{attrs:{disabled:"",value:""}},[t._v("请选择分类")]),t._l(t.categoryData,(function(e){return a("a-select-option",{key:e.name},[t._v(" "+t._s(e.name)+" ")])}))],2)],1)],1),a("a-col",{attrs:{span:12}},[a("a-form-item",{attrs:{label:"文章标签"}},[a("a-select",{staticStyle:{width:"100%"},attrs:{mode:"multiple",placeholder:"请选择标签(支持多选)"},on:{change:t.handleTagChange}},t._l(t.tagData,(function(e){return a("a-select-option",{key:e.name},[t._v(" "+t._s(e.name)+" ")])})),1)],1)],1)],1),a("a-row",{attrs:{gutter:24}},[a("a-col",{attrs:{span:24}},[a("div",{attrs:{id:"main"}},[a("mavon-editor",{ref:"md",on:{imgAdd:t.handleEditorImgAdd},model:{value:t.obj.content,callback:function(e){t.$set(t.obj,"content",e)},expression:"obj.content"}})],1)])],1)],1),a("div",{style:{position:"absolute",right:0,bottom:0,width:"100%",borderTop:"1px solid #e9e9e9",padding:"10px 16px",background:"#fff",textAlign:"right",zIndex:1}},[a("a-switch",{attrs:{defaultChecked:"",checkedChildren:"发布",unCheckedChildren:"草稿"},on:{change:t.onChange},model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}}),a("a-button",{style:{marginRight:"8px"},on:{click:t.onClose}},[t._v(" 取消 ")]),a("a-button",{attrs:{type:"primary"},on:{click:function(e){"create"===t.dialogStatus?t.createData():t.updateData()}}},[t._v(" 确认 ")])],1)],1)],1)},r=[],i=a("efbe"),o=(a("a9b6"),a("c284"),a("49e9"),a("c2e6"),a("28fd"),a("ed3b")),c=(a("e186"),a("7424")),s=a("b775");function u(t){return d.apply(this,arguments)}function d(){return d=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(s["f"])(c["ARTICLE_LIST"],s["a"].GET,e));case 1:case"end":return t.stop()}}),t)}))),d.apply(this,arguments)}function l(t){return p.apply(this,arguments)}function p(){return p=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(s["f"])(c["DELETE_ARTICLE"],s["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),p.apply(this,arguments)}function h(t){return f.apply(this,arguments)}function f(){return f=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(s["f"])(c["ADD_ARTICLE"],s["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),f.apply(this,arguments)}function g(t){return b.apply(this,arguments)}function b(){return b=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(s["f"])(c["UPDATE_ARTICLE"],s["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),b.apply(this,arguments)}function m(t){return w.apply(this,arguments)}function w(){return w=Object(o["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(s["f"])(c["UPLOAD_IMG"],s["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),w.apply(this,arguments)}var v=a("16a4"),y=a("a209"),j=a("be65"),k=a.n(j),O=[{title:"标题",width:250,dataIndex:"title",fixed:"left",class:"title"},{title:"类型",dataIndex:"category",width:150},{title:"创建时间",dataIndex:"created",width:200},{title:"阅读量",dataIndex:"reads",width:150},{title:"评论量",dataIndex:"answer",width:150},{title:"标签",dataIndex:"tag",scopedSlots:{customRender:"tag"},width:200},{title:"状态",dataIndex:"status",scopedSlots:{customRender:"status"},width:150},{title:"操作",key:"operation",fixed:"right",width:200,scopedSlots:{customRender:"action"}}],_={data:function(){var t=this;return{paginationProps:{showSizeChanger:!1,pageSize:10,showQuickJumper:!1,total:0,onChange:function(e){return t.changePage(e)}},headers:{Authorization:""},loading:!1,checked:!0,data:[],categoryData:[],tagData:[],obj:{title:"",img:"",description:"",category:"",tag:"",status:1,content:""},columns:O,visible:!1,dialogStatus:""}},mounted:function(){this.headers.Authorization=k.a.get("Authorization"),this.getPageData()},methods:{changePage:function(t){this.data=[],this.getPage({page:t,limit:this.paginationProps.pageSize})},handleEditorImgAdd:function(t,e){var a=this,n=new FormData;n.append("file",e),m(n).then((function(e){if(200===e.data.code){var n="https://wudongming.com"+e.data.data;a.$refs.md.$img2Url(t,n)}}))},onChange:function(){1==this.checked?this.obj.status=1:this.obj.status=0},showDrawer:function(){this.visible=!0},onClose:function(){this.visible=!1},handleCreate:function(){this.dialogStatus="create",this.visible=!0},createData:function(){var t=this;h(this.obj).then((function(e){if(200===e.data.code){var a=e.data.data;t.data.unshift(a),t.$message.success("添加数据成功")}else t.$message.success("添加数据失败");for(var n in t.obj)t.obj[n]="";t.obj.status=1})),this.visible=!1},handleUpdate:function(t){this.obj=Object.assign({},t),1==this.obj.status?this.checked=!0:this.checked=!1,this.dialogStatus="update",this.visible=!0},updateData:function(){var t=this;g(this.obj).then((function(e){200===e.data.code?(t.$message.success("修改数据成功"),t.data.forEach((function(e){e._id===t.obj._id&&(e.img=t.obj.img,e.tag=t.obj.tag,e.title=t.obj.title,e.status=t.obj.status,e.content=t.obj.content,e.category=t.obj.category,e.description=t.obj.description)}))):t.$message.success("修改数据失败"),t.visible=!1}))},handleTagChange:function(t){this.obj.tag=t},getPage:function(t){var e=this;u(t).then((function(t){200===t.data.code&&(e.data=t.data.data,e.paginationProps.total=t.data.total)}))},getPageData:function(){var t=this;u({page:1,limit:this.paginationProps.pageSize}).then((function(e){200===e.data.code&&(t.data=e.data.data,t.paginationProps.total=e.data.total)})),Object(v["b"])().then((function(e){if(200===e.data.code){var a=e.data.data.filter((function(t){return 1===t.status}));t.categoryData=a}})),Object(y["c"])().then((function(e){if(200===e.data.code){var a=e.data.data.filter((function(t){return 1===t.status}));t.tagData=a}}))},onDelete:function(t){var e=this;l({_id:t}).then((function(a){if(200===a.data.code){var n=Object(i["a"])(e.data);e.data=n.filter((function(e){return e._id!==t})),e.$message.success(a.data.msg)}}))},beforeUpload:function(t){var e="image/jpeg"===t.type||"image/png"===t.type;e||this.$message.error("您只能上传JPG文件!");var a=t.size/1024/1024<2;return a||this.$message.error("图像必须小于2MB!"),e&&a},handleChange:function(t){"uploading"!==t.file.status?"done"===t.file.status&&(this.obj.img="https://wudongming.com"+t.file.response.data,this.loading=!1):this.loading=!0}}},x=_,R=(a("b099"),a("cba8")),T=Object(R["a"])(x,n,r,!1,null,null,null);e["default"]=T.exports},"16a4":function(t,e,a){"use strict";a.d(e,"b",(function(){return o})),a.d(e,"c",(function(){return s})),a.d(e,"a",(function(){return d})),a.d(e,"d",(function(){return p}));var n=a("ed3b"),r=(a("e186"),a("7424")),i=a("b775");function o(){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["CATEGORY"],i["a"].GET));case 1:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function s(t){return u.apply(this,arguments)}function u(){return u=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["DELETE_CATEGORY"],i["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}function d(t){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["ADD_CATEGORY"],i["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function p(t){return h.apply(this,arguments)}function h(){return h=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["UPDATE_CATEGORY"],i["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}},"21b1":function(t,e,a){},a209:function(t,e,a){"use strict";a.d(e,"c",(function(){return o})),a.d(e,"b",(function(){return s})),a.d(e,"a",(function(){return d})),a.d(e,"d",(function(){return p}));var n=a("ed3b"),r=(a("e186"),a("7424")),i=a("b775");function o(){return c.apply(this,arguments)}function c(){return c=Object(n["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["TAG_LIST"],i["a"].GET));case 1:case"end":return t.stop()}}),t)}))),c.apply(this,arguments)}function s(t){return u.apply(this,arguments)}function u(){return u=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["DELETE_TAG"],i["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),u.apply(this,arguments)}function d(t){return l.apply(this,arguments)}function l(){return l=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["ADD_TAG"],i["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),l.apply(this,arguments)}function p(t){return h.apply(this,arguments)}function h(){return h=Object(n["a"])(regeneratorRuntime.mark((function t(e){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.abrupt("return",Object(i["f"])(r["UPDATE_TAG"],i["a"].POST,e));case 1:case"end":return t.stop()}}),t)}))),h.apply(this,arguments)}},b099:function(t,e,a){"use strict";a("21b1")}}]);